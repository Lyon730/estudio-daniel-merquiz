<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estudio Daniel Merquiz</title>
  <link rel="icon" type="image/png" href="assets/Barber-shop-logo.png" />
  
  <!-- Adobe Fonts - Kit ID: mbt5esf -->
  <link rel="stylesheet" href="https://use.typekit.net/mbt5esf.css">
  
  <link rel="stylesheet" href="style.css" />
  
  <!-- Script mejorado para diagnosticar fuentes -->
  <script>
    // Diagn√≥stico inmediato
    console.log('üîç Iniciando diagn√≥stico de fuentes...');
    
    // Verificar si el enlace de Adobe Fonts carga
    fetch('https://use.typekit.net/mbt5esf.css')
      .then(response => {
        console.log('‚úÖ Adobe Fonts CSS:', response.status === 200 ? 'CARGADO' : 'ERROR');
        return response.text();
      })
      .then(css => {
        console.log('üìù CSS de Adobe Fonts:', css.substring(0, 200) + '...');
        
        // Buscar nombres de fuentes en el CSS
        const fontMatches = css.match(/font-family:[^;]+/g);
        if (fontMatches) {
          console.log('üéØ Familias de fuentes encontradas:', fontMatches);
        }
      })
      .catch(error => {
        console.error('‚ùå Error cargando Adobe Fonts:', error);
      });
    
    // Diagn√≥stico cuando las fuentes est√©n listas
    if (document.fonts) {
      document.fonts.ready.then(function() {
        console.log('üìö Fuentes del navegador listas');
        console.log('üìä Total de fuentes cargadas:', document.fonts.size);
        
        // Listar todas las fuentes que contienen "barber"
        let barberFonts = [];
        document.fonts.forEach(function(font) {
          if (font.family.toLowerCase().includes('barber')) {
            barberFonts.push(font.family);
          }
        });
        
        console.log('ü™í Fuentes Barber encontradas:', barberFonts.length > 0 ? barberFonts : 'NINGUNA');
        
        // Probar detecci√≥n de fuente espec√≠ficamente "Barber Complete"
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        context.font = '72px serif';
        const fallbackWidth = context.measureText('Estudio Daniel Merquiz').width;
        context.font = '72px "Barber Complete", serif';
        const testWidth = context.measureText('Estudio Daniel Merquiz').width;
        
        console.log('üîç Test "Barber Complete":', testWidth !== fallbackWidth ? 'BARBER COMPLETE DETECTADA ‚úÖ' : 'USANDO FALLBACK ‚ùå');
      });
    }
    
    // Diagn√≥stico despu√©s de 3 segundos (por si las fuentes tardan)
    setTimeout(() => {
      const h1 = document.querySelector('.hero-overlay h1');
      if (h1) {
        const computedStyle = window.getComputedStyle(h1);
        console.log('üé® Fuente aplicada al t√≠tulo:', computedStyle.fontFamily);
      }
    }, 3000);
  </script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-storage-compat.js"></script>

  <!-- Cloudinary SDK -->
  <script src="cloudinary-config.js"></script>
  <script src="sync-helper.js"></script>

  <script src="config.js"></script>
  <script src="script.js" defer></script>
</head>
<body>
  <header class="hero">
    <video class="hero-video" autoplay muted loop playsinline poster="assets/hero-poster.jpg">
      <source src="assets/video/hero.mp4" type="video/mp4" />
      <source src="assets/video/hero.webm" type="video/webm" />
      <!-- Si el navegador no soporta video, se mostrar√° el poster -->
    </video>
    
    <!-- Logo en esquina superior derecha -->
    <div class="hero-logo">
      <img id="login-logo" src="assets/DanielMerquiz1.png" alt="Daniel Merquiz Logo" style="cursor:pointer;" />
    </div>
    
    <div class="hero-overlay">
      <h1>Estudio Daniel Merquiz</h1>
      <nav>
        <ul>
          <li><a href="#inicio">Inicio</a></li>
          <li><a href="#servicios">Servicios</a></li>
          <li><a href="#productos">Productos</a></li>
          <li><a href="#reservas">Reservas</a></li>
          <li><a href="#contacto">Contacto</a></li>
          <li><a href="#galeria">Galer√≠a</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Men√∫ sticky que aparece al hacer scroll -->
  <nav class="sticky-nav" id="sticky-nav">
    <ul>
      <li><a href="#inicio">Inicio</a></li>
      <li><a href="#servicios">Servicios</a></li>
      <li><a href="#productos">Productos</a></li>
      <li><a href="#reservas">Reservas</a></li>
      <li><a href="#contacto">Contacto</a></li>
      <li><a href="#galeria">Galer√≠a</a></li>
    </ul>
  </nav>

  <main>
    <section id="inicio"><h2>Bienvenidos</h2><p>Tu estilo comienza aqu√≠.</p></section>
    <section id="servicios"><h2>Servicios</h2><p>Cortes, afeitados y m√°s.</p></section>
    <section id="productos" class="productos">
      <h2>Productos</h2>
      <p>Descubre nuestra selecci√≥n de productos profesionales para el cuidado del cabello</p>
      
      <div class="productos-carousel-container">
        <button class="productos-carousel-controls prev" id="productos-prev" onclick="moveProductosCarousel(-1)">
          <span>‚Äπ</span>
        </button>
        
        <div id="productos-grid" class="productos-grid">
          <!-- Los productos se cargar√°n din√°micamente aqu√≠ -->
        </div>
        
        <button class="productos-carousel-controls next" id="productos-next" onclick="moveProductosCarousel(1)">
          <span>‚Ä∫</span>
        </button>
      </div>
      
      <div id="ver-mas-container" class="ver-mas-container" style="display: none;">
        <button id="ver-mas-btn" class="ver-mas-btn" onclick="verMasProductos()">Ver m√°s productos</button>
      </div>
    </section>
    <section id="reservas">
      <h2>Reservas</h2>
      <form id="form-reserva">
        <input type="text" id="nombre" placeholder="Tu nombre" required>
        <input type="tel" id="telefono" placeholder="Tu tel√©fono" required>
        <input type="date" id="fecha-reserva" placeholder="Selecciona una fecha" required onchange="mostrarHorasDisponibles()">
        
        <!-- Container para mostrar las horas disponibles -->
        <div id="horas-disponibles-container" style="display:none;">
          <h3>Horarios Disponibles</h3>
          <div id="horas-disponibles-grid" class="horas-grid">
            <!-- Las horas se mostrar√°n aqu√≠ din√°micamente -->
          </div>
          <input type="hidden" id="hora-seleccionada" required>
        </div>
        
        <button type="submit" id="btn-reservar" disabled>Reservar</button>
      </form>
      <a class="whatsapp-button" id="wa-btn" href="https://wa.me/56996774738" target="_blank" rel="noopener">Agendar por WhatsApp</a>
    </section>
    <section id="contacto">
      <h2>Contacto</h2>
      <p>Ub√≠canos en redes o vis√≠tanos en cualquiera de nuestros locales.</p>
      
      <!-- Redes sociales -->
      <div class="social-media">
        <h3>üì± S√≠guenos en Instagram</h3>
        <a href="https://www.instagram.com/estudio.danielmerquiz?igsh=MWxvMWs4emtld3dpaQ==" target="_blank" rel="noopener" class="instagram-link">
          @estudio.danielmerquiz
        </a>
      </div>
      
      <div class="locations-container">
        <!-- Primera ubicaci√≥n - El Carmen -->
        <div class="location-item">
          <div class="contact-info">
            <div class="contact-details">
              <h3>üìç Estudio El Carmen</h3>
              <p><strong>Direcci√≥n:</strong> Calle 16 de Julio #752</p>
              <p>Te esperamos en nuestro moderno estudio para brindarte la mejor experiencia.</p>
            </div>
            
            <div class="map-container">
              <iframe 
                src="https://www.google.com/maps/embed?pb=!4v1755521355102!6m8!1m7!1soDmV8t-2M72Xu6LA5mXOIA!2m2!1d-36.89990786801867!2d-72.00504877342019!3f268.65512!4f1.1345254984292978!5f0.7820865974627469"
                width="100%" 
                height="300" 
                style="border:0;" 
                allowfullscreen="" 
                loading="lazy" 
                referrerpolicy="no-referrer-when-downgrade">
              </iframe>
            </div>
          </div>
        </div>

        <!-- Segunda ubicaci√≥n - Chill√°n -->
        <div class="location-item">
          <div class="contact-info">
            <div class="contact-details">
              <h3>üìç Estudio Chill√°n</h3>
              <p><strong>Direcci√≥n:</strong> Volc√°n Lascar #1274</p>
              <p>Nuestro segundo estudio con la misma calidad y atenci√≥n personalizada.</p>
            </div>
            
            <div class="map-container">
              <iframe 
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d800.5587188739297!2d-72.08288393046764!3d-36.62073262189544!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x966929c5f85ae385%3A0xc5a55d8eb678e71!2zVm9sY8OhbiBMYXNjYXIgMTI3NCwgMzgxMTQyNyBDaGlsbMOhbiwgw5F1Ymxl!5e0!3m2!1ses-419!2scl!4v1754944589868!5m2!1ses-419!2scl"
                width="100%" 
                height="300" 
                style="border:0;" 
                allowfullscreen="" 
                loading="lazy" 
                referrerpolicy="no-referrer-when-downgrade">
              </iframe>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section id="galeria">
      <h2>Galer√≠a</h2>
      <p>Descubre nuestros mejores trabajos y estilos.</p>
      
      <!-- Carrusel de im√°genes -->
      <div class="gallery-carousel-container">
        <div class="gallery-carousel" id="gallery-carousel">
          <div class="no-gallery-images" id="no-gallery-images">
            <div class="no-images-message">
              <span class="gallery-icon">üì∑</span>
              <h3>Galer√≠a en construcci√≥n</h3>
              <p>Pronto podr√°s ver aqu√≠ nuestros mejores trabajos y estilos.</p>
            </div>
          </div>
          
          <!-- Las im√°genes se cargar√°n din√°micamente aqu√≠ -->
          <div class="carousel-wrapper" id="carousel-wrapper" style="display:none;">
            <div class="carousel-track" id="carousel-track">
              <!-- Im√°genes din√°micas -->
            </div>
            
            <!-- Controles del carrusel -->
            <button class="carousel-control prev" id="carousel-prev" onclick="moveCarousel(-1)">
              <span>‚Äπ</span>
            </button>
            <button class="carousel-control next" id="carousel-next" onclick="moveCarousel(1)">
              <span>‚Ä∫</span>
            </button>
            
            <!-- Indicadores -->
            <div class="carousel-indicators" id="carousel-indicators">
              <!-- Puntos indicadores se generan din√°micamente -->
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal de inicio de sesi√≥n -->
  <div id="login-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.2); z-index:1000; justify-content:center; align-items:center;">
    <div style="background:rgba(255,255,255,0.6); padding:30px; border-radius:8px; min-width:300px; position:relative;">
      <span id="close-login" style="position:absolute; top:10px; right:15px; cursor:pointer; font-size:20px;">&times;</span>
      <h2 style="color:#000;">Iniciar sesi√≥n</h2>
      <form id="admin-login-form">
        <input type="text" id="admin-user" placeholder="Usuario" required style="width:100%; margin-bottom:10px;">
        <input type="password" id="admin-pass" placeholder="Contrase√±a" required style="width:100%; margin-bottom:10px;">
        <button type="submit" style="width:100%;">Entrar</button>
      </form>
      <div id="login-error" style="color:red; margin-top:10px; display:none;">Usuario o contrase√±a incorrectos</div>
    </div>
  </div>

  <!-- Panel de Administraci√≥n -->
  <div id="admin-panel" style="display:none;">
    <div class="admin-header">
      <h1>Administrador</h1>
      <button onclick="logoutAdmin()" class="logout-btn">Cerrar Sesi√≥n</button>
    </div>
    
    <div class="admin-tabs">
      <button class="admin-tab-button active" onclick="showAdminTab('horas-tab')">Gestionar Horas de Atenci√≥n</button>
      <button class="admin-tab-button" onclick="showAdminTab('reservas-tab')">Gestionar Reservas</button>
      <button class="admin-tab-button" onclick="showAdminTab('galeria-tab')">Gestionar Galer√≠a</button>
      <button class="admin-tab-button" onclick="showAdminTab('productos-tab')">Gestionar Productos</button>
    </div>
    
    <div class="admin-content">
      <!-- Pesta√±a Horas de Atenci√≥n -->
      <div id="horas-tab" class="admin-tab-content" style="display:block;">
        <h2>Gestionar Horas de Atenci√≥n</h2>
        <p>Selecciona un d√≠a del calendario para configurar los horarios de trabajo.</p>
        
        <!-- Calendario -->
        <div class="calendar-container">
          <div class="calendar-header">
            <button id="prev-month" onclick="cambiarMes(-1)">&#8249;</button>
            <h3 id="current-month-year"></h3>
            <button id="next-month" onclick="cambiarMes(1)">&#8250;</button>
          </div>
          
          <div class="calendar-grid">
            <div class="day-header">Lun</div>
            <div class="day-header">Mar</div>
            <div class="day-header">Mi√©</div>
            <div class="day-header">Jue</div>
            <div class="day-header">Vie</div>
            <div class="day-header">S√°b</div>
            <div class="day-header">Dom</div>
          </div>
          
          <!-- Los d√≠as se generar√°n din√°micamente con JavaScript -->
          <div id="calendar-days" class="calendar-days-grid"></div>
        </div>
      </div>
      
      <!-- Pesta√±a Reservas -->
      <div id="reservas-tab" class="admin-tab-content" style="display:none;">
        <h2>Gestionar Reservas</h2>
        <p>Aqu√≠ puedes ver todas las citas disponibles seg√∫n los horarios configurados.</p>
        
        <!-- Filtros y controles -->
        <div class="reservas-controls">
          <div class="date-filter">
            <label for="fecha-filtro">Filtrar por fecha:</label>
            <input type="date" id="fecha-filtro" onchange="filtrarReservasPorFecha()">
            <button onclick="mostrarTodasLasReservas()" class="btn-secondary">Mostrar Todas</button>
          </div>
        </div>
        
        <!-- Lista de d√≠as con horarios disponibles -->
        <div id="dias-disponibles" class="dias-container">
          <div class="no-horarios">
            <p>üìÖ No hay horarios configurados a√∫n.</p>
            <p>Ve a la pesta√±a "Gestionar Horas de Atenci√≥n" para configurar los horarios de trabajo.</p>
          </div>
        </div>
      </div>
      
      <!-- Pesta√±a Galer√≠a -->
      <div id="galeria-tab" class="admin-tab-content" style="display:none;">
        <h2>Gestionar Galer√≠a</h2>
        <p>Sube y administra las fotos que aparecer√°n en la galer√≠a del cliente.</p>
        
        <!-- Controles de carga -->
        <div class="galeria-controles">
          <div class="upload-section">
            <h3>üì∏ Subir Nuevas Im√°genes</h3>
            <div class="upload-area" id="upload-area">
              <div class="upload-content">
                <span class="upload-icon">üì∑</span>
                <p>Haz clic aqu√≠ o arrastra las im√°genes</p>
                <small>Formatos: JPG, PNG, WebP (m√°x. 5MB c/u)</small>
              </div>
              <input type="file" id="file-input" accept=".jpg,.jpeg,.png,.webp" multiple hidden>
            </div>
            <div class="upload-progress" id="upload-progress" style="display:none;">
              <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
              </div>
              <div class="progress-text" id="progress-text">Subiendo...</div>
            </div>
          </div>
          
          <!-- Vista previa y gesti√≥n -->
          <div class="preview-section">
            <div class="section-header">
              <h3>üñºÔ∏è Im√°genes de la Galer√≠a</h3>
              <div class="gallery-stats" id="gallery-stats">
                <span class="image-count">0 im√°genes</span>
              </div>
            </div>
            
            <!-- Mensaje informativo para desarrollo -->
            <div class="dev-info" id="dev-info" style="display:none;">
              <div class="info-message">
                <span class="info-icon">‚ÑπÔ∏è</span>
                <div class="info-content">
                  <strong>Modo Local:</strong> Las im√°genes se almacenan localmente en tu navegador. 
                  Para almacenamiento permanente en la nube, configura Firebase Storage en tu servidor.
                  <br><small>Las im√°genes persisten mientras no limpies el cach√© del navegador.</small>
                </div>
              </div>
            </div>
            
            <div class="images-grid" id="admin-images-grid">
              <div class="no-images">
                <p>üì∑ No hay im√°genes en la galer√≠a a√∫n</p>
                <p>Sube algunas fotos para comenzar</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pesta√±a Productos -->
      <div id="productos-tab" class="admin-tab-content" style="display:none;">
        <h2>Gestionar Productos</h2>
        <p>Administra los productos que se venden en la barber√≠a.</p>
        
        <!-- Formulario para agregar productos -->
        <div class="producto-form-section">
          <h3>‚ûï Agregar Nuevo Producto</h3>
          <form id="producto-form" class="producto-form">
            <div class="form-row">
              <div class="form-group">
                <label for="producto-nombre">Nombre del Producto</label>
                <input type="text" id="producto-nombre" required placeholder="Ej: Pomada para cabello">
              </div>
              <div class="form-group">
                <label for="producto-precio">Precio (CLP)</label>
                <input type="number" id="producto-precio" step="1" min="0" required placeholder="3990">
              </div>
            </div>
            
            <div class="form-group">
              <label for="producto-descripcion">Descripci√≥n</label>
              <textarea id="producto-descripcion" rows="3" required placeholder="Describe las caracter√≠sticas del producto..."></textarea>
            </div>
            
            <div class="form-group">
              <label for="producto-imagen">Imagen del Producto</label>
              <div class="producto-upload-area" id="producto-upload-area">
                <div class="upload-content">
                  <span class="upload-icon">üñºÔ∏è</span>
                  <p>Haz clic para seleccionar imagen</p>
                  <small>JPG, PNG, WebP (m√°x. 2MB)</small>
                </div>
                <input type="file" id="producto-imagen-input" accept=".jpg,.jpeg,.png,.webp" hidden>
              </div>
              <div class="imagen-preview" id="imagen-preview" style="display:none;">
                <img id="preview-img" alt="Vista previa">
                <button type="button" class="remove-preview" onclick="removeImagePreview()">‚úï</button>
              </div>
            </div>
            
            <div class="form-actions">
              <button type="submit" class="btn-primary">Agregar Producto</button>
              <button type="button" id="cancel-edit" class="btn-secondary" style="display:none;" onclick="cancelEdit()">Cancelar Edici√≥n</button>
            </div>
          </form>
        </div>
        
        <!-- Lista de productos existentes -->
        <div class="productos-list-section">
          <div class="section-header">
            <h3>üì¶ Productos Actuales</h3>
            <div class="productos-stats" id="productos-stats">
              <span class="productos-count">0 productos</span>
            </div>
          </div>
          
          <div class="productos-admin-grid" id="productos-admin-grid">
            <div class="no-productos-admin">
              <p>üì¶ No hay productos registrados a√∫n</p>
              <p>Agrega algunos productos para comenzar</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para configurar horarios de trabajo -->
  <div id="horarios-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:10000; justify-content:center; align-items:center;">
    <div style="background:#fff; padding:20px; border-radius:8px; width:90%; max-width:450px; max-height:90vh; overflow-y:auto; position:relative; color:#1c1c1c;">
      <span id="close-horarios" style="position:absolute; top:10px; right:15px; cursor:pointer; font-size:20px; color:#666;">&times;</span>
      
      <h2 style="color:#1c1c1c; text-align:center; margin-bottom:10px; font-size:1.3rem;">Configurar Horarios</h2>
      <p id="fecha-seleccionada" style="text-align:center; font-weight:bold; color:#2e2e2e; margin-bottom:20px; font-size:0.9rem;"></p>
      
      <form id="horarios-form">
        <!-- Turno Ma√±ana -->
        <div class="turno-section">
          <h3 style="color:#2e2e2e; margin-bottom:10px; font-size:1.1rem;">üåÖ Turno Ma√±ana</h3>
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:15px;">
            <div>
              <label style="display:block; margin-bottom:3px; font-weight:bold; font-size:0.85rem;">Hora Inicio:</label>
              <input type="time" id="manana-inicio" style="width:100%; padding:6px; border:1px solid #ccc; border-radius:4px; font-size:0.9rem;">
            </div>
            <div>
              <label style="display:block; margin-bottom:3px; font-weight:bold; font-size:0.85rem;">Hora T√©rmino:</label>
              <input type="time" id="manana-fin" style="width:100%; padding:6px; border:1px solid #ccc; border-radius:4px; font-size:0.9rem;">
            </div>
          </div>
        </div>
        
        <!-- Turno Tarde -->
        <div class="turno-section">
          <h3 style="color:#2e2e2e; margin-bottom:10px; font-size:1.1rem;">üåÜ Turno Tarde</h3>
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:20px;">
            <div>
              <label style="display:block; margin-bottom:3px; font-weight:bold; font-size:0.85rem;">Hora Inicio:</label>
              <input type="time" id="tarde-inicio" style="width:100%; padding:6px; border:1px solid #ccc; border-radius:4px; font-size:0.9rem;">
            </div>
            <div>
              <label style="display:block; margin-bottom:3px; font-weight:bold; font-size:0.85rem;">Hora T√©rmino:</label>
              <input type="time" id="tarde-fin" style="width:100%; padding:6px; border:1px solid #ccc; border-radius:4px; font-size:0.9rem;">
            </div>
          </div>
        </div>
        
        <!-- Informaci√≥n adicional -->
        <div style="background:#f8f9fa; padding:10px; border-radius:6px; margin-bottom:15px;">
          <p style="margin:0; font-size:0.8rem; color:#666;">
            ‚ÑπÔ∏è <strong>Nota:</strong> Las citas se programar√°n cada 30 minutos dentro de los horarios establecidos.
          </p>
        </div>
        
        <!-- Botones -->
        <div style="display:flex; gap:8px; justify-content:flex-end;">
          <button type="button" onclick="cerrarModalHorarios()" style="background:#6c757d; color:white; border:none; padding:8px 16px; border-radius:4px; cursor:pointer; font-size:0.9rem;">
            Cancelar
          </button>
          <button type="submit" style="background:#28a745; color:white; border:none; padding:8px 16px; border-radius:4px; cursor:pointer; font-size:0.9rem;">
            Guardar Horarios
          </button>
        </div>
      </form>
    </div>
  </div>

  <footer><p>&copy; 2025 Estudio Daniel Merquiz</p></footer>
</body>
</html>
